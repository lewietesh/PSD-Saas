{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<div style="max-width: 800px; margin: 40px auto; padding: 20px;">
    <h1 style="margin-bottom: 20px; color: #333;">Assign Partner to Orders</h1>
    
    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
        <h3 style="margin-top: 0; color: #555;">Selected Orders ({{ orders|length }})</h3>
        <ul style="list-style: none; padding: 0;">
            {% for order in orders %}
            <li style="padding: 8px; background: white; margin: 5px 0; border-radius: 3px; border-left: 3px solid #007bff;">
                <strong>Order #{{ order.id }}</strong> - {{ order.client.email }}
                {% if order.service %}
                    (Service: {{ order.service.name }})
                {% elif order.product %}
                    (Product: {{ order.product.name }})
                {% endif %}
                {% if order.assigned_partner %}
                    <br><small style="color: #6c757d;">Currently assigned to: {{ order.assigned_partner.user.get_full_name|default:order.assigned_partner.user.email }}</small>
                {% else %}
                    <br><small style="color: #dc3545;">Not assigned</small>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>

    <form method="post" style="background: white; padding: 20px; border-radius: 5px; border: 1px solid #ddd;">
        {% csrf_token %}
        
        <div style="margin-bottom: 20px;">
            <label for="id_partner" style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">
                {{ form.partner.label }}
            </label>
            {{ form.partner }}
            {% if form.partner.help_text %}
            <p style="margin-top: 5px; color: #6c757d; font-size: 14px;">{{ form.partner.help_text }}</p>
            {% endif %}
            {% if form.partner.errors %}
            <p style="color: #dc3545; margin-top: 5px;">{{ form.partner.errors }}</p>
            {% endif %}
        </div>

        <div style="display: flex; gap: 10px; justify-content: flex-end;">
            <a href="{% url 'admin:business_order_changelist' %}" 
               style="padding: 10px 20px; background: #6c757d; color: white; text-decoration: none; border-radius: 4px; display: inline-block;">
                Cancel
            </a>
            <button type="submit" name="apply" 
                    style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">
                Assign Partner
            </button>
        </div>
    </form>
</div>

<style>
    select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 16px;
        background-color: white;
    }
    
    select:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
    }
</style>
{% endblock %}
